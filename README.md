# Лабораторная работа 3
## Создание виртуальной сети машин
Поскольку про доступ в интренет машины **Б** и машины **В** ничего не сказано, предположим, что они его не имеют. Тогда неплохим будет решение организовать изолированную сеть виртуальных машин. Для этого при помощи инструментов VirtualBox создаем Host-Only Network - сеть, в которой машины будут взаимодействовать.
![image](assets/1.png)

## Настройка машины А
Отныне виртуальную машину, на которой были сделаны предыдущие лабораторные работы будем называть машиной **А**.

Машина А уже имеет доступ к интернету, но для работы с сетью виртуальных машин необходимо добавить второй адаптер к хостовой сети:
![image](assets/2.png)

Проверяем подключение к сети Интернет машины **А**:
![image](assets/3.png)

Доступ имеется.
Теперь узнаем IP-адрес в сети:
```bash
zalof@machine-1:~$ hostname -I
10.0.2.15 192.168.1.1
```
Первый адрес - это адрес из NAT сети с доступом в интернет, второй - адрес в локальной сети.

## Настройка машины Б
Теперь создаем машину **Б**.
Изначально пытался клонировать уже существующую машину, но это вызвало несколько ошибок с опорными модулями, поэтому решил создать с нуля из того же образа.
В параметрах сети указываем подключение к нашей Host-Only Network.

Узнаем её адрес: `192.168.1.4`
Проверяем подключение:
![image](assets/4.png)

## Настройка машины В
Создание и настройка этой машины аналогична процессу создани и настройки машины **Б**.
Адрес: `192.168.1.6`
Подключение тоже есть:
![image](assets/5.png)

## Запрет доступа из Б в В
Для того, чтобы запретить доступ машины **Б** к машине **В** можно использовать инструмент настройки фаервола iptables. 
Введем команду:
```bash
sudo iptables -A OUTPUT -d 192.168.1.6 -j DROP
```
Где `-A` означает добавление нового правила в фаервол;
`OUTPUT` - исходящие пакеты;
`-d` - адрес машины, в которую посылаются пакеты;
`-j` - действие, которое должно быть выполнено при передаче пакета по указанному адресу;
`DROP` - отмена отправки пакета без возвращения ошибки.

Получаем желанный результат:
![image](assets/6.png)

